package com.atmospherebbdo.application {	import com.atmospherebbdo.animation.Animator;	import com.atmospherebbdo.dbc.precondition;	import com.atmospherebbdo.log.ILog;	import com.atmospherebbdo.log.LogFactory;	import com.atmospherebbdo.log.LogLevel;	import com.atmospherebbdo.util.FlashVars;	import com.atmospherebbdo.util.IDestroyable;	import com.atmospherebbdo.util.contextmenu.versionStamp;		import flash.display.MovieClip;	import flash.display.Stage;		/**	 * Base class for application-level projects. Handles logging, flash vars,	 * blah blah blah.	 * 	 * @author mark hawley	 */	public class Application extends MovieClip implements IDestroyable	{		protected var log:ILog;		protected var flashVars:FlashVars;				// looks like a constant, at least		public static var THE_STAGE:Stage;				private var _isDestroyed:Boolean = false;				/**		 * Constructor.		 * 		 * @param	description	ApplicationDescription		 */		public function Application( description:ApplicationDescription=null )		{			if (null == description)			{				description = new ApplicationDescription();			}			initialize( description );		}				/**		 * Cleans up. Should be called before removing all references to the 		 * application.		 */		public function destroy() :void		{			precondition(!isDestroyed());						log = null;			flashVars = null;						_isDestroyed = true;		}				/**		 * Returns true if this instance is still 'good'.		 * 		 * @return Boolean		 */		public function isDestroyed():Boolean		{			return _isDestroyed;		}		/**		 * Performs basic app initialization: logging setup, animation types,		 * flash var parsing, etc. SHould be overridden for most applications.		 * 		 * @param	description	ApplicationDescription		 */		protected function initialize( description:ApplicationDescription ) :void		{				precondition(!isDestroyed());						if (description.logDestinations != null)			{				LogFactory.setDestinations.apply(LogFactory, description.logDestinations);			}						log = LogFactory.getLog(this, LogLevel.INFO);			log.info("%s(%s)", "initialize", arguments);						Animator.defaultAnimationPackage = description.animationPackage;			log.info("Default animation package set: '%s'", description.animationPackage);						flashVars = FlashVars.getFlashVars( this, description.defaultFlashVars );			log.info("FlashVars read: '%s'", flashVars);						// place the build version/date into the right-click menu			versionStamp( this );						if (stage != null)			{				THE_STAGE = stage;			}			log.info("Application initialized: '%s'", this);		}	}}